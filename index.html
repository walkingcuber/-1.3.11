<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>é€²éšé­”è¡“æ–¹å¡Šè¨ˆæ™‚å™¨</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Segoe UI',sans-serif;display:flex;min-height:100vh;background:#1e1e2f;color:white;}
.sidebar{width:300px;background:rgba(0,0,0,0.3);backdrop-filter:blur(8px);padding:1rem;overflow-y:auto;border-right:1px solid rgba(255,255,255,0.1);max-height:100vh;}
.sidebar h2{font-size:1.2rem;margin-bottom:1rem;}
.stats-card{background:rgba(34,197,94,0.2);border-radius:.75rem;padding:.75rem;margin-bottom:.5rem;}
.stats-card .label{font-size:.75rem;color:#86efac;}
.stats-card .value{font-size:1.25rem;font-weight:bold;color:#bbf7d0;}
.records{margin-top:1rem;max-height:400px;overflow-y:auto;}
.records h3{font-size:.875rem;color:#9ca3af;margin-bottom:.5rem;}
.record-item{background:rgba(255,255,255,0.05);border-radius:.5rem;padding:.5rem;margin-bottom:.5rem;display:flex;justify-content:space-between;align-items:center;cursor:pointer;}
.record-item:hover{background:rgba(255,255,255,0.1);}
.record-number{background:rgba(0,0,0,0.5);color:#9ca3af;border-radius:.25rem;padding:.1rem .25rem;margin-right:.25rem;}
.record-time{font-weight:bold;}
.record-info{display:flex;align-items:center;}
.main-content{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative;}
.scramble-card{background:rgba(255,255,255,0.05);padding:1rem;border-radius:1rem;margin-bottom:1rem;max-width:900px;width:100%;}
.scramble-label{font-size:.875rem;color:#9ca3af;margin-bottom:.25rem;}
.scramble-text{font-size:1.25rem;text-align:center;font-family:'Courier New',monospace;}
.timer-card{background:rgba(255,255,255,0.05);padding:2rem;border-radius:1rem;max-width:900px;width:100%;display:flex;align-items:center;justify-content:center;cursor:pointer;}
.timer-display{font-size:clamp(4rem,12vw,8rem);font-weight:bold;transition:color 0.2s;}
.modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.6);backdrop-filter:blur(4px);z-index:1000;align-items:center;justify-content:center;}
.modal-overlay.active{display:flex;}
.modal{background:rgba(17,24,39,0.95);border-radius:1rem;padding:1.5rem;max-width:500px;width:90%;}
.modal h3{font-size:1.25rem;margin-bottom:1rem;}
.form-group{margin-bottom:1rem;}
.form-group label{display:block;margin-bottom:.25rem;font-size:.875rem;color:#d1d5db;}
.form-group select,input{width:100%;padding:.5rem;border-radius:.25rem;background:#1f2937;border:1px solid #4b5563;color:white;font-size:1rem;}
.modal-actions{margin-top:1rem;display:flex;gap:.5rem;}
.btn{padding:.5rem 1rem;border-radius:.25rem;border:none;font-weight:bold;cursor:pointer;transition:all .2s;}
.btn-danger{background:#ef4444;color:white;flex:1;}
.btn-secondary{background:#374151;color:white;flex:1;}
</style>
</head>
<body>
<aside class="sidebar">
<h2>ğŸ† æˆç¸¾çµ±è¨ˆ</h2>
<div id="stats"></div>
<div class="records">
<h3>æ­·å²è¨˜éŒ„</h3>
<div id="recordsList"></div>
</div>
</aside>
<main class="main-content">
<div class="scramble-card">
<div class="scramble-label">æ‰“äº‚å…¬å¼</div>
<div class="scramble-text" id="scramble">è¼‰å…¥ä¸­...</div>
</div>
<div class="timer-card" id="timerCard">
<div class="timer-display" id="timerDisplay">0.000</div>
</div>
</main>
<div class="modal-overlay" id="modalOverlay">
<div class="modal" id="recordModal">
<h3>ç´€éŒ„è©³ç´°</h3>
<div><strong>æ™‚é–“:</strong> <span id="modalTime"></span></div>
<div><strong>æ‰“äº‚:</strong> <span id="modalScramble"></span></div>
<div class="form-group">
<label>æ‡²ç½°</label>
<select id="modalPenalty">
<option value="none">ç„¡</option>
<option value="+2">+2</option>
<option value="DNF">DNF</option>
</select>
</div>
<div class="modal-actions">
<button class="btn btn-danger" id="deleteRecordBtn">åˆªé™¤</button>
<button class="btn btn-secondary" onclick="closeModal()">é—œé–‰</button>
</div>
</div>
</div>
<script>
let time=0,isRunning=false,records=[],currentEvent='3x3x3',scramble='',timerInterval=null,startTime=0,timerReady=false,timerTouch=false,currentRecordId=null;
const timerDisplay=document.getElementById('timerDisplay');
const scrambleEl=document.getElementById('scramble');
const statsEl=document.getElementById('stats');
const recordsList=document.getElementById('recordsList');

function formatTime(ms){let s=Math.floor(ms/1000),m=Math.floor(s/60);s=s%60;let msRem=ms%1000;return `${m>0?m+':':''}${s}.${msRem.toString().padStart(3,'0')}`;}
function generateScramble(){const moves=['R','L','U','D','F','B','R\'','L\'','U\'','D\'','F\'','B\'','R2','L2','U2','D2','F2','B2'];let scr='';for(let i=0;i<25;i++){scr+=moves[Math.floor(Math.random()*moves.length)]+' ';}return scr.trim();}

function startTimer(){if(isRunning)return;isRunning=true;startTime=Date.now();timerInterval=setInterval(()=>{time=Date.now()-startTime;timerDisplay.textContent=formatTime(time);},10);}
function stopTimer(){if(!isRunning)return;isRunning=false;clearInterval(timerInterval);const finalTime=time;const rec={id:Date.now(),time:finalTime,scramble:scramble,event:currentEvent,date:new Date(),penalty:'none'};records.unshift(rec);updateRecords();scramble=generateScramble();scrambleEl.textContent=scramble;}

function updateRecords(){recordsList.innerHTML='';records.forEach((r,i)=>{const div=document.createElement('div');div.className='record-item';div.innerHTML=`<div class='record-info'><span class='record-number'>${i+1}</span><span class='record-time'>${formatTime(r.time)}</span></div>`;div.onclick=()=>openModal(r.id);recordsList.appendChild(div);});updateStats();}

function updateStats(){if(records.length===0){statsEl.innerHTML='ç„¡ç´€éŒ„';return;}let times=records.map(r=>r.time);let best=Math.min(...times);let ao5=times.length>=5?Math.round(times.slice(0,5).sort((a,b)=>a-b).slice(1,4).reduce((a,b)=>a+b,0)/3):0;let ao12=times.length>=12?Math.round(times.slice(0,12).sort((a,b)=>a-b).slice(1,11).reduce((a,b)=>a+b,0)/10):0;statsEl.innerHTML=`<div class='stats-card'><div class='label'>æœ€ä½³æ™‚é–“</div><div class='value'>${formatTime(best)}</div></div><div class='stats-card'><div class='label'>Ao5</div><div class='value'>${ao5?formatTime(ao5):'-'}</div></div><div class='stats-card'><div class='label'>Ao12</div><div class='value'>${ao12?formatTime(ao12):'-'}</div></div>`;}

function openModal(id){currentRecordId=id;const rec=records.find(r=>r.id===id);document.getElementById('modalTime').textContent=formatTime(rec.time);document.getElementById('modalScramble').textContent=rec.scramble;document.getElementById('modalPenalty').value=rec.penalty;document.getElementById('modalOverlay').classList.add('active');}
function closeModal(){document.getElementById('modalOverlay').classList.remove('active');}

document.getElementById('modalPenalty').addEventListener('change',(e)=>{const rec=records.find(r=>r.id===currentRecordId);rec.penalty=e.target.value;updateRecords();});
document.getElementById('deleteRecordBtn').addEventListener('click',()=>{records=records.filter(r=>r.id!==currentRecordId);updateRecords();closeModal();});

// ç©ºç™½éµè§¸æ§äº‹ä»¶
document.addEventListener('keydown',e=>{
  if(e.code==='Space' && !timerReady){
    if(!isRunning){
      timerDisplay.style.color='yellow';
      timerReady=true;
      setTimeout(()=>{timerDisplay.style.color='lime';timerTouch=true;},1000);
    } else {
      stopTimer();
    }
  }
});
document.addEventListener('keyup',e=>{
  if(e.code==='Space' && timerTouch){
    timerDisplay.style.color='white';
    timerReady=false;
    timerTouch=false;
    startTimer();
  }
});

// è§¸æ§æ¨¡å¼
const timerCard=document.getElementById('timerCard');
timerCard.addEventListener('touchstart',()=>{
  if(!isRunning && !timerReady){
    timerDisplay.style.color='yellow';
    timerReady=true;
    setTimeout(()=>{timerDisplay.style.color='lime';timerTouch=true;},1000);
  }
});
timerCard.addEventListener('touchend',()=>{
  if(timerTouch){
    timerDisplay.style.color='white';
    timerReady=false;
    timerTouch=false;
    startTimer();
  } else if(isRunning){
    stopTimer();
  }
});
timerCard.addEventListener('click',()=>{if(isRunning)stopTimer();});

// åˆå§‹åŒ–
scramble=generateScramble();scrambleEl.textContent=scramble;updateRecords();
</script>
</body>
</html>
