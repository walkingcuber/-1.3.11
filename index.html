<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å°ˆæ¥­é­”è¡“æ–¹å¡Šè¨ˆæ™‚å™¨</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    min-height: 100vh;
    background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #7e22ce 100%);
    color: white;
    display: flex;
    gap: 1rem;
    padding: 1rem;
  }
  .sidebar { width: 280px; background: rgba(0,0,0,0.3); backdrop-filter: blur(10px); border-radius:1rem; padding:1rem; overflow-y:auto; border:1px solid rgba(255,255,255,0.1); }
  .sidebar h2 { font-size:1.25rem; margin-bottom:1rem; display:flex; align-items:center; gap:0.5rem; }
  .stats-card { background: linear-gradient(135deg, rgba(34,197,94,0.2), rgba(16,185,129,0.2)); border:1px solid rgba(34,197,94,0.3); border-radius:0.75rem; padding:1rem; margin-bottom:0.75rem; }
  .stats-card .label { font-size:0.75rem; color: rgba(134,239,172,1); margin-bottom:0.25rem; }
  .stats-card .value { font-size:1.5rem; font-weight:bold; color: rgba(187,247,208,1); }
  .stats-grid { display:grid; grid-template-columns:1fr 1fr; gap:0.5rem; margin-bottom:0.75rem; }
  .stat-small { background: rgba(59,130,246,0.1); border:1px solid rgba(59,130,246,0.2); border-radius:0.5rem; padding:0.5rem; }
  .stat-small .label { font-size:0.7rem; color: rgba(147,197,253,1); }
  .stat-small .value { font-size:1rem; font-weight:bold; color: rgba(191,219,254,1); }
  .records { margin-top:1rem; }
  .records h3 { font-size:0.75rem; color: rgba(156,163,175,1); margin-bottom:0.5rem; }
  .record-item { background: rgba(255,255,255,0.05); border:1px solid rgba(255,255,255,0.05); border-radius:0.5rem; padding:0.75rem; margin-bottom:0.5rem; display:flex; justify-content:space-between; align-items:center; transition:all 0.2s; }
  .record-item:hover { background: rgba(255,255,255,0.1); border-color: rgba(255,255,255,0.2); }
  .record-number { background: rgba(0,0,0,0.5); color: rgba(156,163,175,1); border:1px solid rgba(75,85,99,1); font-size:0.7rem; padding:0.125rem 0.375rem; border-radius:0.25rem; }
  .record-time { font-weight:bold; font-size:1rem; }
  .record-date { font-size:0.7rem; color: rgba(156,163,175,1); }
  .delete-btn { background:transparent; border:none; color: rgba(248,113,113,1); cursor:pointer; opacity:0; transition:opacity 0.2s; font-size:1.2rem; padding:0.25rem 0.5rem; }
  .record-item:hover .delete-btn { opacity:1; }
  .main-content { flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center; }
  .scramble-card { background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); border:1px solid rgba(255,255,255,0.1); border-radius:1rem; padding:1.5rem; margin-bottom:1.5rem; max-width:900px; width:100%; }
  .scramble-label { font-size:0.875rem; color: rgba(156,163,175,1); margin-bottom:0.5rem; }
  .scramble-text { font-size:1.25rem; text-align:center; background: rgba(0,0,0,0.2); border-radius:0.75rem; padding:1rem; font-family:'Courier New', monospace; min-height:3rem; }
  .timer-card { background: rgba(255,255,255,0.05); backdrop-filter: blur(10px); border:1px solid rgba(255,255,255,0.1); border-radius:1rem; padding:3rem; max-width:900px; width:100%; cursor:pointer; position:relative; }
  .timer-display { font-size: clamp(4rem, 12vw, 8rem); font-weight:bold; text-align:center; transition:all 0.3s; }
  .settings-btn { margin-top:1.5rem; background: linear-gradient(90deg, #3b82f6, #8b5cf6); border:none; color:white; padding:0.75rem 1.5rem; border-radius:0.75rem; font-size:1rem; font-weight:600; cursor:pointer; transition:all 0.2s; }
  .settings-btn:hover { transform:translateY(-2px); box-shadow:0 10px 20px rgba(0,0,0,0.3); }
  .modal-overlay { display:none; position:fixed; inset:0; background: rgba(0,0,0,0.6); backdrop-filter: blur(4px); z-index:1000; }
  .modal-overlay.active { display:flex; align-items:center; justify-content:center; }
  .modal { background: rgba(17,24,39,0.95); border:1px solid rgba(75,85,99,1); border-radius:1rem; padding:1.5rem; max-width:500px; width:90%; }
  .modal h3 { font-size:1.5rem; margin-bottom:1.5rem; }
  .form-group { margin-bottom:1.5rem; }
  .form-group label { display:block; color: rgba(209,213,219,1); margin-bottom:0.5rem; font-size:0.875rem; }
  .form-group select { width:100%; background: rgba(31,41,55,1); border:1px solid rgba(75,85,99,1); color:white; padding:0.75rem; border-radius:0.5rem; font-size:1rem; }
  .theme-grid { display:grid; grid-template-columns:1fr 1fr; gap:0.75rem; }
  .theme-btn { padding:1rem; border:2px solid rgba(75,85,99,1); border-radius:0.5rem; background:transparent; cursor:pointer; transition:all 0.2s; }
  .theme-btn.active { border-color:white; transform:scale(1.05); }
  .theme-preview { height:2rem; border-radius:0.5rem; margin-bottom:0.5rem; }
  .theme-name { font-size:0.875rem; color: rgba(209,213,219,1); }
  .modal-actions { margin-top:1.5rem; padding-top:1.5rem; border-top:1px solid rgba(75,85,99,1); display:flex; gap:0.75rem; }
  .btn { padding:0.75rem 1.5rem; border:none; border-radius:0.5rem; font-size:0.875rem; font-weight:600; cursor:pointer; transition:all 0.2s; }
  .btn-danger { background:#ef4444; color:white; flex:1; }
  .btn-danger:hover { background:#dc2626; }
  .btn-secondary { background:transparent; border:1px solid rgba(75,85,99,1); color:white; }
  .btn-secondary:hover { background: rgba(75,85,99,0.3); }
  @media (max-width:768px) { body { flex-direction:column; } .sidebar { width:100%; max-height:300px; } }
</style>
</head>
<body>
<aside class="sidebar">
  <h2>ğŸ† æˆç¸¾çµ±è¨ˆ</h2>
  <div id="stats"></div>
  <div class="records">
    <h3>æ­·å²è¨˜éŒ„</h3>
    <div id="recordsList"></div>
  </div>
</aside>

<main class="main-content">
  <div class="scramble-card">
    <div class="scramble-label">æ‰“äº‚å…¬å¼</div>
    <div class="scramble-text" id="scramble">è¼‰å…¥ä¸­...</div>
  </div>

  <div class="timer-card" id="timerCard">
    <div class="timer-display" id="timerDisplay">0.000</div>
  </div>

  <button class="settings-btn" onclick="openSettings()">âš™ï¸ è¨­å®š</button>
</main>

<div class="modal-overlay" id="modalOverlay" onclick="closeSettings()">
  <div class="modal" onclick="event.stopPropagation()">
    <h3>è¨ˆæ™‚å™¨è¨­å®š</h3>
    <div class="form-group">
      <label>é­”è¡“æ–¹å¡Šé¡å‹</label>
      <select id="eventSelect" onchange="changeEvent()">
        <option value="2x2x2">2Ã—2Ã—2 é­”è¡“æ–¹å¡Š</option>
        <option value="3x3x3" selected>3Ã—3Ã—3 é­”è¡“æ–¹å¡Š</option>
        <option value="4x4x4">4Ã—4Ã—4 é­”è¡“æ–¹å¡Š</option>
        <option value="5x5x5">5Ã—5Ã—5 é­”è¡“æ–¹å¡Š</option>
        <option value="Square-1">Square-1</option>
        <option value="Pyraminx">é‡‘å­—å¡”é­”è¡“æ–¹å¡Š</option>
        <option value="Clock">é­”éŒ¶</option>
        <option value="Megaminx">äº”é­”æ–¹</option>
        <option value="Skewb">æ–œè½‰é­”è¡“æ–¹å¡Š</option>
      </select>
    </div>
    <div class="form-group">
      <label>ä»‹é¢ä¸»é¡Œ</label>
      <div class="theme-grid">
        <button class="theme-btn active" onclick="changeTheme('aurora', this)">
          <div class="theme-preview" style="background: linear-gradient(90deg, #1e3c72, #2a5298, #7e22ce)"></div>
          <div class="theme-name">æ¥µå…‰æ¼¸å±¤</div>
        </button>
        <button class="theme-btn" onclick="changeTheme('neon', this)">
          <div class="theme-preview" style="background: linear-gradient(90deg, #06b6d4, #14b8a6, #10b981)"></div>
          <div class="theme-name">éœ“è™¹é›»å…‰</div>
        </button>
        <button class="theme-btn" onclick="changeTheme('sunset', this)">
          <div class="theme-preview" style="background: linear-gradient(90deg, #f97316, #ef4444, #ec4899)"></div>
          <div class="theme-name">æ—¥è½é¤˜æš‰</div>
        </button>
        <button class="theme-btn" onclick="changeTheme('ocean', this)">
          <div class="theme-preview" style="background: linear-gradient(90deg, #0c4a6e, #1e40af, #06b6d4)"></div>
          <div class="theme-name">æ·±æµ·è—èª¿</div>
        </button>
      </div>
    </div>
    <div class="modal-actions">
      <button class="btn btn-danger" onclick="clearAllRecords()">æ¸…é™¤æ‰€æœ‰è¨˜éŒ„</button>
      <button class="btn btn-secondary" onclick="closeSettings()">é—œé–‰</button>
    </div>
  </div>
</div>

<script>
let time = 0;
let isRunning = false;
let status = 'idle';
let records = [];
let currentEvent = '3x3x3';
let scramble = '';
let timerInterval = null;
let startTime = 0;

const THEMES = {
  aurora: 'linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #7e22ce 100%)',
  neon: 'linear-gradient(135deg, #06b6d4 0%, #14b8a6 50%, #10b981 100%)',
  sunset: 'linear-gradient(135deg, #f97316 0%, #ef4444 50%, #ec4899 100%)',
  ocean: 'linear-gradient(135deg, #0c4a6e 0%, #1e40af 50%, #06b6d4 100%)'
};

// æ‰“äº‚å…¬å¼ç”Ÿæˆå‡½æ•¸ (ç°¡åŒ–)
function generateScramble(event){
  const moves = { '2x2x2':["R","U","F"], '3x3x3':["R","L","U","D","F","B"], '4x4x4':["R","L","U","D","F","B","Rw","Lw","Uw","Dw","Fw","Bw"], '5x5x5':["R","L","U","D","F","B","Rw","Lw","Uw","Dw","Fw","Bw"] };
  if(event==='Square-1'){let r=[];for(let i=0;i<12;i++){r.push(`(${Math.floor(Math.random()*12)-5},${Math.floor(Math.random()*12)-5})`);} return r.join(' / ');}
  if(event==='Megaminx'){const m=['R++','R--','D++','D--','U'];let r=[];for(let i=0;i<70;i++){r.push(m[Math.floor(Math.random()*m.length)]);} return r.join(' ');}
  if(event==='Pyraminx'){const m=['U','L','R','B','u','l','r','b'],mod=['','\''];let r=[];for(let i=0;i<10;i++){r.push(m[Math.floor(Math.random()*m.length)]+mod[Math.floor(Math.random()*mod.length)]);} return r.join(' ');}
  if(event==='Clock'){return 'UR4+ DR1+ DL3+ UL2+ U3+ R4+ D2+ L1+ ALL5+ y2 U4+ R2+ D3+ L1+ ALL3+';}
  if(event==='Skewb'){const m=['R','L','U','B'],mod=['','\''];let r=[];for(let i=0;i<9;i++){r.push(m[Math.floor(Math.random()*m.length)]+mod[Math.floor(Math.random()*mod.length)]);} return r.join(' ');}
  const base=moves[event]||moves['3x3x3']; const mod=['','\'','2']; let r=[]; let last=''; const len=event==='2x2x2'?9:20;
  for(let i=0;i<len;i++){let mv; do{mv=base[Math.floor(Math.random()*base.length)];}while(mv[0]===last[0]); r.push(mv+mod[Math.floor(Math.random()*mod.length)]); last=mv;}
  return r.join(' ');
}

function formatTime(ms){const s=Math.floor(ms/1000); const msr=ms%1000; return `${s}.${msr.toString().padStart(3,'0')}`;}

function updateTimer(){time=Date.now()-startTime; document.getElementById('timerDisplay').textContent=formatTime(time);}

function startTimer(){
  if(isRunning){stopTimer(); return;}
  if(status==='ready'){
    isRunning=true; startTime=Date.now(); time=0;
    timerInterval=setInterval(updateTimer,10);
    updateDisplay();
  }
}

function stopTimer(){
  isRunning=false;
  clearInterval(timerInterval);
  const finalTime=Date.now()-startTime;
  records.unshift({id:Date.now(),time:finalTime,scramble:scramble,event:currentEvent,date:new Date()});
  updateRecords(); updateStats();
  scramble=generateScramble(currentEvent);
  document.getElementById('scramble').textContent=scramble;
  updateDisplay();
}

function updateDisplay(){
  const d=document.getElementById('timerDisplay'); let color='#E5E7EB';
  if(status==='ready') color='#4ADE80'; else if(isRunning) color='#60A5FA';
  d.style.color=color; d.style.textShadow=isRunning?`0 0 40px ${color}`:'none';
}

function updateStats(){
  if(records.length===0){document.getElementById('stats').innerHTML=`<div class="stats-card"><div class="label">å°šç„¡è¨˜éŒ„</div></div>`; return;}
  const times=records.map(r=>r.time); const best=Math.min(...times); const worst=Math.max(...times); const avg=(times.reduce((a,b)=>a+b,0)/times.length).toFixed(3);
  document.getElementById('stats').innerHTML=`
    <div class="stats-card"><div class="label">æœ€ä½³æ™‚é–“</div><div class="value">${formatTime(best)}</div></div>
    <div class="stats-card"><div class="label">æœ€å·®æ™‚é–“</div><div class="value">${formatTime(worst)}</div></div>
    <div class="stats-card"><div class="label">å¹³å‡æ™‚é–“</div><div class="value">${formatTime(avg)}</div></div>
  `;
}

function updateRecords(){
  const list=document.getElementById('recordsList'); list.innerHTML='';
  records.forEach((r,i)=>{
    const div=document.createElement('div'); div.className='record-item';
    div.innerHTML=`<div><div class="record-number">#${i+1}</div><div class="record-time">${formatTime(r.time)}</div><div class="record-date">${r.date.toLocaleString()}</div></div><button class="delete-btn" onclick="deleteRecord(${r.id})">ğŸ—‘ï¸</button>`;
    list.appendChild(div);
  });
}

function deleteRecord(id){records=records.filter(r=>r.id!==id); updateRecords(); updateStats();}

function clearAllRecords(){records=[]; updateRecords(); updateStats();}

function openSettings(){document.getElementById('modalOverlay').classList.add('active');}
function closeSettings(){document.getElementById('modalOverlay').classList.remove('active');}
function changeEvent(){currentEvent=document.getElementById('eventSelect').value; scramble=generateScramble(currentEvent); document.getElementById('scramble').textContent=scramble;}
function changeTheme(theme, btn){document.body.style.background=THEMES[theme]; document.querySelectorAll('.theme-btn').forEach(b=>b.classList.remove('active')); btn.classList.add('active');}

// ç©ºæ ¼éµæ§åˆ¶è¨ˆæ™‚å™¨
document.addEventListener('keydown',function(e){
  if(e.code==='Space' && !isRunning && status==='idle'){e.preventDefault(); status='ready'; updateDisplay();}
});
document.addEventListener('keyup',function(e){
  if(e.code==='Space'){e.preventDefault(); if(status==='ready'){startTimer();} status='idle'; updateDisplay();}
});
document.getElementById('timerCard').addEventListener('click',()=>{if(isRunning) stopTimer();});

window.addEventListener('DOMContentLoaded',()=>{
  scramble=generateScramble(currentEvent);
  document.getElementById('scramble').textContent=scramble;
  updateStats();
  updateRecords();
  updateDisplay();
});
</script>
</body>
</html>
